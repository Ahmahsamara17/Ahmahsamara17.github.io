[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.14.8","content-config-digest","5e692615b8bb6b3b","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://ahmahsamara17.github.io/my_website/\",\"compressHTML\":true,\"base\":\"/my_website/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true,\"allowedDomains\":[]},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false,\"failOnPrerenderConflict\":false},\"legacy\":{\"collections\":false}}","writeups",["Map",11,12],"explanitory",{"id":11,"data":13,"body":17,"filePath":18,"digest":19,"rendered":20,"legacyId":52},{"title":14,"date":15,"summary":16},"HackTheBox — Buffer Overflow 101","2025-10-22","A beginner’s look at exploiting a simple buffer overflow vulnerability.","# Coppersmith's Method and RSA\n## Introduction\nThe following is a guide for understanding the application of Coppersmith's Theorem to attacks on the RSA cryptosystem. Although many refer to such as Coppersmith's attack, it is actually a class of attacks which can be applied to many relaxed version of the RSA cryptosystem. Coppersmith's thoerm is a statement about finding \"small\" roots of finite field polynomials. The general class of attacks on RSA involves converting partial information about RSA secrets into polynomials whose \"small\" roots will be something desireable for us.\n\n## RSA $\\rightarrow$ Polynomial\nAt first glance there is no polynomial to be seen in the RSA equations. We have some practice with this sort of thing already, as its the same principle when we used lattices to crack cryptosystems where there was no lattice present. We can take information present in a cryptosystem and represent it as a polynomial that we can construct using known information, but that we know has small roots at secret information we want. This is analogous to how we construct a lattice basis using public information which we know contains a short, or close vector which represent desireable information.\n\nRecall the primary way to defeat RSA is by factoring the public modulus $n = pq$ where $p$ and $q$ are prime. When we create polynomails, we want to keep their roots as our primary focus. This means they shall evaluate to $0$ when the variables are where we want them. Rearranging the previous equation we get $n - pq = 0$. In other words, the polynomial $f(x,y) = n - xy$ has a roots at $(1, n), (n, 1), (p, q), (q, p)$. We have just constructed our first polynomial from the RSA cryptosystem!\n\nNow these methods cannot be used to solve RSA given just the public modulus of course. The most common usecase for a Coppersmith attack would be when we are leaked some bits of secret RSA key material. For example if we are given the $k$ least significant bits of $p$, or the $k$ most significant bits of $d$, etc. So the reason our previous polynomial isn't solveable (in a reasonable amount of time) is that its roots aren't \"small\" enough. When we say \"small\", what we really mean is that the size of the root must be significantly lower than the size of the coefficients. In the previous equation our smallest roots where around $\\sqrt{n}$. Our coefficient is $1$, so coppersmith isn't going to fly.\n\n## Example\nWe will start with an example where we have somehow obtained half the MSBs of $p$. Whenever we have some kind of approximation of a value, it is helpfull to write it in some algebraic form. If we have $\\ell$ MSBs, then we can say $p = 2^\\ell b + r$ where $b$ is known and $r$ is not. Let $a = 2^\\ell b$. Now solving $r$ would crack RSA, as then we would know $p$ and could factor $n$. So we want to construct a modular polynomial where when the variable of the polynomial $x$ is what we care about, the polynoamial evaluates to $0$. Without too much time we way think up $f(x) = a + x$. Now when $x = r$, the value we want to find, $f(r) = p \\equiv 0 \\pmod{p}$. So $r$ is a root of the polynomial $f \\in \\mathbb{F}_p$.\n\n\n### Challenge Here (poly.py)\nHave the user successfully create the polynomial for the case where a chunk of the plaintext is known (formatted encrypted message example: `Session Cookie: {user: \"admin\", secret: \"REDACTED\"}`)\n\n## Solving the polynomials\nNow that we have a polynomail with small roots that we would like to solve, how can we actually do so. Its time to delve a bit more into Coppersmith's Method. We will start by describing Coppersmith's method, and after will arrive at the final statement. This will finally allow us to describe how we know if the roots are \"small\" enough to work.\n\nThe basic idea behind Coppersmith's method is given some modular polynomial $f(x)$, we constrct a new polynomial $g(x)$ over the integers which has the same roots as $f(x)$ under some specific bound $X$. We can then use standard methods to find the roots of $g(x)$ (sage, maple, mathematica, etc.). More rigerously, for some univariate polynomial $f(x)$, for every root $x_0 \\leq X$\n$$\nf(x_0) \\equiv 0 \\pmod{b} \\implies g(x_0) = 0 \\text{ over }\\mathbb{Z}\n$$\n\nConstructing $g(x)$ is a two step process:\n\n1. We pick some $m \\in \\mathbb{Z}$. We construct a set of polynomials $f_1(x), f_2(x), \\dots, f_n(x)$ that all have the same bounded roots $x_0$ modulo $b^m$.\n\n2. Construct integer linear combination $g(x) = \\sum\\limits_{i=1}^na_if_i(x), a_i \\in \\mathbb{Z}$ where $\\left|g(x_0)\\right| \u003C b^m$.\n\nYou may see why LLL is useful here, as to get $g(x)$ we want a bounded integer linear combination of other polynomials. In practice we let the coefficient vectors of each $f_i$ be the basis of a lattice. Every point in this lattice then represents an integer linear combination of our polynomials. Applying LLL to this lattice will give us a short vector, hopefully satisfing the requirement that its norm is in the $b^m$ bound. Note that this vector itself represents a polynomial $g(x)$. Since it is a linear combination of polynomials that have $x_0 \u003C X$ as a root modulo $b^m$, this $g(x)$ too must have that root. But we know the norm of $g \u003C b^m$, so $x_0$ will also be a root over the integers, hence we have found our $g(x)$.\n\nExplaining precisely why $f_1, \\dots, f_n$ are chosen to work is beyond the depth of this dojo. It is sufficient to understand that the following algorithmic construction will work. Note that here $f^n(x)$ refers to $(f(x))^n$ and not function composition.\n\nWith polynomial $f(x)$ of degree $\\delta$, some $N$ of unknown factorization where $b$ divides $N$ and $b \\geq N^\\beta$, $\\epsilon \\leq \\frac{1}{7}\\beta$\n\nPick $m = \\lceil \\frac{\\beta^2}{\\delta\\epsilon} \\rceil$ and $t = \\lfloor \\delta m (\\frac{1}{\\beta} - 1) \\rfloor$ Define polynomials\n$$\n\\begin{array}{rcll}\ng_{i,j}(x) &=& x^jN^if^{m-i}(x) &\\text{ for } i=0, \\dots, m, j=0, \\dots, \\delta-1 \\\\\nh_i(x) &=& x^if^m(x) &\\text{ for } i=0, \\dots, t-1\n\\end{array}\n$$\n\nThen our bound for the root $X$ can be set as $\\frac{1}{2}\\lceil N^{\\frac{\\beta^2}{\\delta} - \\epsilon} \\rceil$. Finally then our final set of polynomials can be made by taking $g_{i,j}(xX)$ and $h_i(xX)$. Its time to try applying this method to our example polynomial $f(x) = a + x$.\n\n## Example cont.\nRecall our polynomial $f(x) = a + x \\pmod{p}$. So $f$ has degree $1$ and modulus $p$, which is a devisor to $n$, an integer with unknown factorization. So in our example $\\delta = 1, N = n, b = p$. For us to apply coppersmith we need a bound on $p$, and because this is RSA, we can say $p \\geq n^{\\frac{1}{2}}$, so $\\beta = \\frac{1}{2}$.\n\nFollowing the procedure we pick $\\epsilon = \\frac{1}{14}, m = \\lceil \\frac{0.5^2}{\\frac{1}{14}} \\rceil = 4, t = \\lfloor4(\\frac{1}{0.5} - 1)\\rfloor = 4$.\n\nThis makes our polynomial collection the following:\n\n$$\n\\begin{aligned}\ng_{0,0}(x) &= f^4(x) = (a + x)^4 \\\\\ng_{1,0}(x) &= N \\cdot f^3(x) = n(a+x)^3 \\\\\ng_{2,0}(x) &= N^2 \\cdot f^2(x) = n^2(a+x)^2 \\\\\ng_{3,0}(x) &= N^3 \\cdot f(x) = n^3(a+x) \\\\\ng_{4,0}(x) &= N^4 = n^4 \\\\\nh_0(x) &= f^4(x) = (a+x)^4 \\\\\nh_1(x) &= xf^4(x) = x(a + x)^4 \\\\\nh_2(x) &= x^2f^4(x) = x^2(a + x)^4 \\\\\nh_3(x) &= x^3f^4(x) = x^3(a + x)^4 \\\\\n\\end{aligned}\n$$\n\nThere is one duplicate, $h_0(x) = g_{0,0}(x)$, so we can just keep one. In practice we generate these programatically. (ADD CHALLENGE FOR THIS?) If you want you can confirm that they all share $r$, the unknown part of $p$, as a root modulo $p^4$. The coefficient vectors of these polynomials will form the basis of our lattice, however to force the lattice to have a short vector caused by a polynomial with small coefficients, we scale using our bound $X = \\frac{1}{2}\\lceil n^{\\frac{0.5^2}{1} - \\frac{1}{14}} \\rceil$. This in short makes the basis work better with LLL and we can simply undo the scaling on our result. We apply this scaling on $x$, so get get the scaled polynomials we replace $x$ with $X\\cdot x$. The end result of this is for every term we multiply the coefficient by $X^i$ where $i$ is the degree of the $x$ in that term. \n\nThe signifigance of this basis is that vectors in the lattice will be coefficient vectors of other polynomials that also have a root at $r$ modulo $p^2$, since they will be integer linear combinations of the polynomials in our collection. Here is our example lattice C where the basis vectors are row vectors. We typically write these in the order that gives us a matrix in lower triangular form. This is part of why we construct the polynomials in this way as it will speed up computation.\n\n$$\nC = \n\\begin{bmatrix}\nn^4 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\nn^3 a & n^3 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\nn^2 a^2 & 2n^2 a & n^2 & 0 & 0 & 0 & 0 & 0 \\\\\nn a^3 & 3n a^2 & 3n a & n & 0 & 0 & 0 & 0 \\\\\na^4 & 4a^3 & 6a^2 & 4a & 1 & 0 & 0 & 0 \\\\\n0 & a^4 & 4a^3 & 6a^2 & 4a & 1 & 0 & 0 \\\\\n0 & 0 & a^4 & 4a^3 & 6a^2 & 4a & 1 & 0 \\\\\n0 & 0 & 0 & a^4 & 4a^3 & 6a^2 & 4a & 1 \\\\\n\\end{bmatrix}\n$$\n\nNow we are ready to perform LLL. This will give us a very short vector in this lattice, and by construction after we undo our scaling, it will represent the polynomial with a root at $r$, but because its a short vector, this root holds over the integers and not just modulo $p^4$. Below is some example sage code constructing the lattice and performing LLL on it to output the unscaled short vector.\n\n```python\nfrom sage.all import *\nimport math\n\n# Define constants and parameters\nn = 107128401073044027100681037389887740716521103060290623291122384286996880400023528826224275942920880949998999448939756402810515386455973123190538040891365549603423153398595403572680081839274379248558404242559377609047545113638120418973477394283579889347397789081230300757082270481957055782290912119977343304617\n\na = 11362493659989432775838845656824927721682432808905230131710928675556356019964132792869246031985380953809978267033181147473976831249784131242268603382235136\n\ndelta = 1\nbeta = 0.5\nepsilon = 1/14\nm = 4\nt = 4\nX = math.ceil(n**(((beta**2)/delta)-epsilon))//2\n\n# Construct Lattice from scaled coefficient vectors\nC = Matrix(ZZ, [\n    [n**4, 0, 0, 0, 0, 0, 0, 0],\n    [n**3*a, n**3*X, 0, 0, 0, 0, 0, 0],\n    [n**2*a**2, 2*n**2*a*X, n**2*X**2, 0, 0, 0, 0, 0],\n    [n*a**3, 3*n*a**2*X, 3*n*a*X**2, n*X**3, 0, 0, 0, 0],\n    [a**4, 4*a**3*X, 6*a**2*X**2, 4*a*X**3, X**4, 0, 0, 0],\n    [0, a**4*X, 4*a**3*X**2, 6*a**2*X**3, 4*a*X**4, X**5, 0, 0],\n    [0, 0, a**4*X**2, 4*a**3*X**3, 6*a**2*X**4, 4*a*X**5, X**6, 0],\n    [0, 0, 0, a**4*X**3, 4*a**3*X**4, 6*a**2*X**5, 4*a*X**6, X**7]\n])\n\n\n# Apply LLL reduction and scale back to unscaled coefficient vector\nL = C.LLL()\nshort_vec = L[0]\nunscaled = [val//(X**i) for i, val in enumerate(short_vec)]\nprint(unscaled)\n```\n\nRunning this yields:\n\n\n So now we have a polynomial that hopefully has a root at $r$ over the integers, ignoring the $p^2$ modulus. There are a few different ways we might try and solve this. In some simpler cases, where we are given much more of $p$, our polynomial is of the form $g(x) = x^2 + Bx + A$. Its a quadratic and so we can just apply the quadratic formula. We are demonstrating a harder example given only half of $p$. There a bunch of techniques out there for finding integer roots of many types of polynomials like our 7 degree beast here. Luckily `sage` has a general root finding function which can be applied to finding integer roots, and finding roots over the integers without any modulus is well studied and quite fast.\n\n If we have a sage polynomial $g$, we can call `g.roots()`. To construct the sage polynomial from our coefficient vector, we first create a polynomial ring `R` making sure to pass `ZZ` so sage knows its integers only. Then we can do `g = R(vec)` where `vec` is our coefficient vector as a python list.\n\n ```python\nR = PolynomialRing(ZZ, 'x') # Construct polynomial ring over the integers with variable x\ng = R(vec) # Get polynomial from coefficient vector vec\ng.roots() # returns a list of tuples representing the root and its multiplicity\n ```","src/content/writeups/explanitory.md","f45446fe29b7b38a",{"html":21,"metadata":22},"\u003Ch1 id=\"coppersmiths-method-and-rsa\">Coppersmith’s Method and RSA\u003C/h1>\n\u003Ch2 id=\"introduction\">Introduction\u003C/h2>\n\u003Cp>The following is a guide for understanding the application of Coppersmith’s Theorem to attacks on the RSA cryptosystem. Although many refer to such as Coppersmith’s attack, it is actually a class of attacks which can be applied to many relaxed version of the RSA cryptosystem. Coppersmith’s thoerm is a statement about finding “small” roots of finite field polynomials. The general class of attacks on RSA involves converting partial information about RSA secrets into polynomials whose “small” roots will be something desireable for us.\u003C/p>\n\u003Ch2 id=\"rsa-rightarrow-polynomial\">RSA $\\rightarrow$ Polynomial\u003C/h2>\n\u003Cp>At first glance there is no polynomial to be seen in the RSA equations. We have some practice with this sort of thing already, as its the same principle when we used lattices to crack cryptosystems where there was no lattice present. We can take information present in a cryptosystem and represent it as a polynomial that we can construct using known information, but that we know has small roots at secret information we want. This is analogous to how we construct a lattice basis using public information which we know contains a short, or close vector which represent desireable information.\u003C/p>\n\u003Cp>Recall the primary way to defeat RSA is by factoring the public modulus $n = pq$ where $p$ and $q$ are prime. When we create polynomails, we want to keep their roots as our primary focus. This means they shall evaluate to $0$ when the variables are where we want them. Rearranging the previous equation we get $n - pq = 0$. In other words, the polynomial $f(x,y) = n - xy$ has a roots at $(1, n), (n, 1), (p, q), (q, p)$. We have just constructed our first polynomial from the RSA cryptosystem!\u003C/p>\n\u003Cp>Now these methods cannot be used to solve RSA given just the public modulus of course. The most common usecase for a Coppersmith attack would be when we are leaked some bits of secret RSA key material. For example if we are given the $k$ least significant bits of $p$, or the $k$ most significant bits of $d$, etc. So the reason our previous polynomial isn’t solveable (in a reasonable amount of time) is that its roots aren’t “small” enough. When we say “small”, what we really mean is that the size of the root must be significantly lower than the size of the coefficients. In the previous equation our smallest roots where around $\\sqrt{n}$. Our coefficient is $1$, so coppersmith isn’t going to fly.\u003C/p>\n\u003Ch2 id=\"example\">Example\u003C/h2>\n\u003Cp>We will start with an example where we have somehow obtained half the MSBs of $p$. Whenever we have some kind of approximation of a value, it is helpfull to write it in some algebraic form. If we have $\\ell$ MSBs, then we can say $p = 2^\\ell b + r$ where $b$ is known and $r$ is not. Let $a = 2^\\ell b$. Now solving $r$ would crack RSA, as then we would know $p$ and could factor $n$. So we want to construct a modular polynomial where when the variable of the polynomial $x$ is what we care about, the polynoamial evaluates to $0$. Without too much time we way think up $f(x) = a + x$. Now when $x = r$, the value we want to find, $f(r) = p \\equiv 0 \\pmod{p}$. So $r$ is a root of the polynomial $f \\in \\mathbb{F}_p$.\u003C/p>\n\u003Ch3 id=\"challenge-here-polypy\">Challenge Here (poly.py)\u003C/h3>\n\u003Cp>Have the user successfully create the polynomial for the case where a chunk of the plaintext is known (formatted encrypted message example: \u003Ccode>Session Cookie: {user: \"admin\", secret: \"REDACTED\"}\u003C/code>)\u003C/p>\n\u003Ch2 id=\"solving-the-polynomials\">Solving the polynomials\u003C/h2>\n\u003Cp>Now that we have a polynomail with small roots that we would like to solve, how can we actually do so. Its time to delve a bit more into Coppersmith’s Method. We will start by describing Coppersmith’s method, and after will arrive at the final statement. This will finally allow us to describe how we know if the roots are “small” enough to work.\u003C/p>\n\u003Cp>The basic idea behind Coppersmith’s method is given some modular polynomial $f(x)$, we constrct a new polynomial $g(x)$ over the integers which has the same roots as $f(x)$ under some specific bound $X$. We can then use standard methods to find the roots of $g(x)$ (sage, maple, mathematica, etc.). More rigerously, for some univariate polynomial $f(x)$, for every root $x_0 \\leq X$\n$$\nf(x_0) \\equiv 0 \\pmod{b} \\implies g(x_0) = 0 \\text{ over }\\mathbb{Z}\n$$\u003C/p>\n\u003Cp>Constructing $g(x)$ is a two step process:\u003C/p>\n\u003Col>\n\u003Cli>\n\u003Cp>We pick some $m \\in \\mathbb{Z}$. We construct a set of polynomials $f_1(x), f_2(x), \\dots, f_n(x)$ that all have the same bounded roots $x_0$ modulo $b^m$.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Construct integer linear combination $g(x) = \\sum\\limits_{i=1}^na_if_i(x), a_i \\in \\mathbb{Z}$ where $\\left|g(x_0)\\right| &#x3C; b^m$.\u003C/p>\n\u003C/li>\n\u003C/ol>\n\u003Cp>You may see why LLL is useful here, as to get $g(x)$ we want a bounded integer linear combination of other polynomials. In practice we let the coefficient vectors of each $f_i$ be the basis of a lattice. Every point in this lattice then represents an integer linear combination of our polynomials. Applying LLL to this lattice will give us a short vector, hopefully satisfing the requirement that its norm is in the $b^m$ bound. Note that this vector itself represents a polynomial $g(x)$. Since it is a linear combination of polynomials that have $x_0 &#x3C; X$ as a root modulo $b^m$, this $g(x)$ too must have that root. But we know the norm of $g &#x3C; b^m$, so $x_0$ will also be a root over the integers, hence we have found our $g(x)$.\u003C/p>\n\u003Cp>Explaining precisely why $f_1, \\dots, f_n$ are chosen to work is beyond the depth of this dojo. It is sufficient to understand that the following algorithmic construction will work. Note that here $f^n(x)$ refers to $(f(x))^n$ and not function composition.\u003C/p>\n\u003Cp>With polynomial $f(x)$ of degree $\\delta$, some $N$ of unknown factorization where $b$ divides $N$ and $b \\geq N^\\beta$, $\\epsilon \\leq \\frac{1}{7}\\beta$\u003C/p>\n\u003Cp>Pick $m = \\lceil \\frac{\\beta^2}{\\delta\\epsilon} \\rceil$ and $t = \\lfloor \\delta m (\\frac{1}{\\beta} - 1) \\rfloor$ Define polynomials\n$$\n\\begin{array}{rcll}\ng_{i,j}(x) &#x26;=&#x26; x^jN^if^{m-i}(x) &#x26;\\text{ for } i=0, \\dots, m, j=0, \\dots, \\delta-1 \\\nh_i(x) &#x26;=&#x26; x^if^m(x) &#x26;\\text{ for } i=0, \\dots, t-1\n\\end{array}\n$$\u003C/p>\n\u003Cp>Then our bound for the root $X$ can be set as $\\frac{1}{2}\\lceil N^{\\frac{\\beta^2}{\\delta} - \\epsilon} \\rceil$. Finally then our final set of polynomials can be made by taking $g_{i,j}(xX)$ and $h_i(xX)$. Its time to try applying this method to our example polynomial $f(x) = a + x$.\u003C/p>\n\u003Ch2 id=\"example-cont\">Example cont.\u003C/h2>\n\u003Cp>Recall our polynomial $f(x) = a + x \\pmod{p}$. So $f$ has degree $1$ and modulus $p$, which is a devisor to $n$, an integer with unknown factorization. So in our example $\\delta = 1, N = n, b = p$. For us to apply coppersmith we need a bound on $p$, and because this is RSA, we can say $p \\geq n^{\\frac{1}{2}}$, so $\\beta = \\frac{1}{2}$.\u003C/p>\n\u003Cp>Following the procedure we pick $\\epsilon = \\frac{1}{14}, m = \\lceil \\frac{0.5^2}{\\frac{1}{14}} \\rceil = 4, t = \\lfloor4(\\frac{1}{0.5} - 1)\\rfloor = 4$.\u003C/p>\n\u003Cp>This makes our polynomial collection the following:\u003C/p>\n\u003Cp>$$\n\\begin{aligned}\ng_{0,0}(x) &#x26;= f^4(x) = (a + x)^4 \\\ng_{1,0}(x) &#x26;= N \\cdot f^3(x) = n(a+x)^3 \\\ng_{2,0}(x) &#x26;= N^2 \\cdot f^2(x) = n^2(a+x)^2 \\\ng_{3,0}(x) &#x26;= N^3 \\cdot f(x) = n^3(a+x) \\\ng_{4,0}(x) &#x26;= N^4 = n^4 \\\nh_0(x) &#x26;= f^4(x) = (a+x)^4 \\\nh_1(x) &#x26;= xf^4(x) = x(a + x)^4 \\\nh_2(x) &#x26;= x^2f^4(x) = x^2(a + x)^4 \\\nh_3(x) &#x26;= x^3f^4(x) = x^3(a + x)^4 \\\n\\end{aligned}\n$$\u003C/p>\n\u003Cp>There is one duplicate, $h_0(x) = g_{0,0}(x)$, so we can just keep one. In practice we generate these programatically. (ADD CHALLENGE FOR THIS?) If you want you can confirm that they all share $r$, the unknown part of $p$, as a root modulo $p^4$. The coefficient vectors of these polynomials will form the basis of our lattice, however to force the lattice to have a short vector caused by a polynomial with small coefficients, we scale using our bound $X = \\frac{1}{2}\\lceil n^{\\frac{0.5^2}{1} - \\frac{1}{14}} \\rceil$. This in short makes the basis work better with LLL and we can simply undo the scaling on our result. We apply this scaling on $x$, so get get the scaled polynomials we replace $x$ with $X\\cdot x$. The end result of this is for every term we multiply the coefficient by $X^i$ where $i$ is the degree of the $x$ in that term.\u003C/p>\n\u003Cp>The signifigance of this basis is that vectors in the lattice will be coefficient vectors of other polynomials that also have a root at $r$ modulo $p^2$, since they will be integer linear combinations of the polynomials in our collection. Here is our example lattice C where the basis vectors are row vectors. We typically write these in the order that gives us a matrix in lower triangular form. This is part of why we construct the polynomials in this way as it will speed up computation.\u003C/p>\n\u003Cp>$$\nC =\n\\begin{bmatrix}\nn^4 &#x26; 0 &#x26; 0 &#x26; 0 &#x26; 0 &#x26; 0 &#x26; 0 &#x26; 0 \\\nn^3 a &#x26; n^3 &#x26; 0 &#x26; 0 &#x26; 0 &#x26; 0 &#x26; 0 &#x26; 0 \\\nn^2 a^2 &#x26; 2n^2 a &#x26; n^2 &#x26; 0 &#x26; 0 &#x26; 0 &#x26; 0 &#x26; 0 \\\nn a^3 &#x26; 3n a^2 &#x26; 3n a &#x26; n &#x26; 0 &#x26; 0 &#x26; 0 &#x26; 0 \\\na^4 &#x26; 4a^3 &#x26; 6a^2 &#x26; 4a &#x26; 1 &#x26; 0 &#x26; 0 &#x26; 0 \\\n0 &#x26; a^4 &#x26; 4a^3 &#x26; 6a^2 &#x26; 4a &#x26; 1 &#x26; 0 &#x26; 0 \\\n0 &#x26; 0 &#x26; a^4 &#x26; 4a^3 &#x26; 6a^2 &#x26; 4a &#x26; 1 &#x26; 0 \\\n0 &#x26; 0 &#x26; 0 &#x26; a^4 &#x26; 4a^3 &#x26; 6a^2 &#x26; 4a &#x26; 1 \\\n\\end{bmatrix}\n$$\u003C/p>\n\u003Cp>Now we are ready to perform LLL. This will give us a very short vector in this lattice, and by construction after we undo our scaling, it will represent the polynomial with a root at $r$, but because its a short vector, this root holds over the integers and not just modulo $p^4$. Below is some example sage code constructing the lattice and performing LLL on it to output the unscaled short vector.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sage.all \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> math\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Define constants and parameters\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">n \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 107128401073044027100681037389887740716521103060290623291122384286996880400023528826224275942920880949998999448939756402810515386455973123190538040891365549603423153398595403572680081839274379248558404242559377609047545113638120418973477394283579889347397789081230300757082270481957055782290912119977343304617\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">a \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 11362493659989432775838845656824927721682432808905230131710928675556356019964132792869246031985380953809978267033181147473976831249784131242268603382235136\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">delta \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">beta \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0.5\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">epsilon \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\">14\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">m \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">t \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">X \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> math.ceil(n\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(((beta\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">delta)\u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">epsilon))\u003C/span>\u003Cspan style=\"color:#F97583\">//\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Construct Lattice from scaled coefficient vectors\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">C \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Matrix(\u003C/span>\u003Cspan style=\"color:#79B8FF\">ZZ\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, [\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [n\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">],\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [n\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a, n\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">],\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [n\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">n\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X, n\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">],\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [n\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">n\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X, \u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">n\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, n\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">],\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X, \u003C/span>\u003Cspan style=\"color:#79B8FF\">6\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">],\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X, \u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">6\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">],\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">6\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">],\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">6\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#79B8FF\">7\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">])\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Apply LLL reduction and scale back to unscaled coefficient vector\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">L \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> C.LLL()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">short_vec \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> L[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">unscaled \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [val\u003C/span>\u003Cspan style=\"color:#F97583\">//\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(X\u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">i) \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i, val \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> enumerate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(short_vec)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(unscaled)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Running this yields:\u003C/p>\n\u003Cp>So now we have a polynomial that hopefully has a root at $r$ over the integers, ignoring the $p^2$ modulus. There are a few different ways we might try and solve this. In some simpler cases, where we are given much more of $p$, our polynomial is of the form $g(x) = x^2 + Bx + A$. Its a quadratic and so we can just apply the quadratic formula. We are demonstrating a harder example given only half of $p$. There a bunch of techniques out there for finding integer roots of many types of polynomials like our 7 degree beast here. Luckily \u003Ccode>sage\u003C/code> has a general root finding function which can be applied to finding integer roots, and finding roots over the integers without any modulus is well studied and quite fast.\u003C/p>\n\u003Cp>If we have a sage polynomial $g$, we can call \u003Ccode>g.roots()\u003C/code>. To construct the sage polynomial from our coefficient vector, we first create a polynomial ring \u003Ccode>R\u003C/code> making sure to pass \u003Ccode>ZZ\u003C/code> so sage knows its integers only. Then we can do \u003Ccode>g = R(vec)\u003C/code> where \u003Ccode>vec\u003C/code> is our coefficient vector as a python list.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">R \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> PolynomialRing(\u003C/span>\u003Cspan style=\"color:#79B8FF\">ZZ\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'x'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#6A737D\"># Construct polynomial ring over the integers with variable x\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">g \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> R(vec) \u003C/span>\u003Cspan style=\"color:#6A737D\"># Get polynomial from coefficient vector vec\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">g.roots() \u003C/span>\u003Cspan style=\"color:#6A737D\"># returns a list of tuples representing the root and its multiplicity\u003C/span>\u003C/span>\u003C/code>\u003C/pre>",{"headings":23,"localImagePaths":48,"remoteImagePaths":49,"frontmatter":50,"imagePaths":51},[24,28,32,35,38,42,45],{"depth":25,"slug":26,"text":27},1,"coppersmiths-method-and-rsa","Coppersmith’s Method and RSA",{"depth":29,"slug":30,"text":31},2,"introduction","Introduction",{"depth":29,"slug":33,"text":34},"rsa-rightarrow-polynomial","RSA $\\rightarrow$ Polynomial",{"depth":29,"slug":36,"text":37},"example","Example",{"depth":39,"slug":40,"text":41},3,"challenge-here-polypy","Challenge Here (poly.py)",{"depth":29,"slug":43,"text":44},"solving-the-polynomials","Solving the polynomials",{"depth":29,"slug":46,"text":47},"example-cont","Example cont.",[],[],{"title":14,"date":15,"summary":16},[],"explanitory.md"]